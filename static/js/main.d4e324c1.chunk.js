(this["webpackJsonpkics-scan-builder"]=this["webpackJsonpkics-scan-builder"]||[]).push([[0],{119:function(e,t,a){e.exports={content:"content_content__1oH_F"}},120:function(e,t,a){e.exports={childrenGroup:"radiogroup_childrenGroup__2CqSV"}},141:function(e,t,a){},214:function(e,t,a){"use strict";a.r(t);var l=a(0),i=a.n(l),n=a(25),c=a.n(n),s=a(36),r=(a(141),a(219)),o=a(64),u=a.n(o),d=a.p+"static/media/logo.162eb795.png",f=a(226),b=a(4),j=r.a.Header,x=function(){return Object(b.jsxs)(j,{className:u.a.header,children:[Object(b.jsxs)("div",{className:u.a.headerDiv,children:[Object(b.jsx)("img",{src:d,className:"App-logo",alt:"logo",style:{maxHeight:"48px"}}),Object(b.jsx)("span",{className:u.a.title,children:"Kics Scan Builder"})]}),Object(b.jsx)("a",{href:"https://github.com/cxlucas/kics-scan-builder",target:"_blank",rel:"noopener noreferrer",className:u.a.headerDiv,children:Object(b.jsx)(f.a,{className:u.a.githubIcon})})]})},p=a(119),h=a.n(p),g=r.a.Content,m=function(e){var t=e.children;return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(g,{className:h.a.content,children:t})})},O=a(222),v=a(225),A=a(216),_=a(129),D=a(46),y=a.n(D),C=A.a.Step,N=function(e){var t=e.stepsList,a=Object(l.useState)(0),i=Object(s.a)(a,2),n=i[0],c=i[1],r=function(e){c(e)};return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(A.a,{current:n,onChange:r,children:t.map((function(e){return Object(b.jsx)(C,{title:e.title,description:e.description},e.title)}))}),Object(b.jsx)("div",{className:y.a.container,children:Object(b.jsx)(O.a,{gutter:[16,40],className:y.a.container,children:t[n].content})}),Object(b.jsxs)("div",{className:y.a.stepsAction,children:[Object(b.jsxs)("div",{className:y.a.stepsAction,children:[n>0&&Object(b.jsx)(_.a,{className:y.a.button,onClick:function(){c(n-1)},children:"Previous Step"}),n<t.length-1&&Object(b.jsx)(_.a,{className:y.a.button,type:"primary",onClick:function(){c(n+1)},children:"Next Step"})]}),Object(b.jsx)(_.a,{className:y.a.buttonFinish,type:"primary",disabled:n===t.length-1,onClick:function(){return r(t.length-1)},children:"Finish"})]})]})},k=a(96),q=a.n(k),w=function(e){var t=e.title,a=e.children;return Object(b.jsxs)("div",{className:q.a.boxContainer,children:[t&&Object(b.jsx)("span",{className:q.a.boxTitle,children:t}),Object(b.jsx)("div",{className:q.a.boxDiv,children:a})]})},S=a(106),F={data:[{flag:"source",value:"",flagAux:"docker",required:!0},{flag:"path",value:"https://github.com/dockersamples/node-bulletin-board",flagAux:"git",required:!0},{flag:"queries-path",value:"",flagAux:"default",required:!0}]},T=function(e,t){if("ADD"===t.type){var a=e.data.filter((function(e){return e.flag!==t.data.flag}));return a.push(t.data),Object(S.a)(Object(S.a)({},e),{},{data:a})}return e},I=Object(l.createContext)({state:F,dispatch:function(){return null}}),L=a(221),E=a(120),R=a.n(E),P=function(e){var t=e.flag,a=e.items,i=e.defaultIndex,n=void 0===i?0:i,c=Object(l.useContext)(I),r=c.state,o=c.dispatch,u=function(e,t){return"".concat(e,"-").concat(t)},d=r.data.filter((function(e){return e.flag===t}))[0],f=Object(l.useState)(d?u(d.flag,d.flagAux):u(a[n].flag,a[n].flagAux)),j=Object(s.a)(f,2),x=j[0],p=j[1],h=a.filter((function(e){return u(e.flag,e.flagAux)===x&&e.children}));return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(L.a.Group,{onChange:function(e){p(e.target.value);var t=a.filter((function(t){return u(t.flag,t.flagAux)===e.target.value}))[0];t&&o({type:"ADD",data:{flag:t.flag,value:"",flagAux:t.flagAux,required:null===t||void 0===t?void 0:t.required}})},value:x,children:a.map((function(e){return Object(b.jsx)(L.a,{value:u(e.flag,e.flagAux),children:e.label},u(e.flag,e.flagAux))}))}),h.length>0&&Object(b.jsx)("div",{className:R.a.childrenGroup,children:Object(b.jsx)(w,{children:h[0].children})})]})},V=a(217),G=a(223),K=a(71),M=a.n(K),U=a(134),B=function(e){var t=e.flag,a=e.flagAux,i=e.label,n=e.placeholder,c=e.description,s=e.defaultValue,r=void 0===s?"":s,o=e.required,u=void 0!==o&&o,d=Object(l.useContext)(I),f=d.state,j=d.dispatch,x=f.data.filter((function(e){return e.flag===t&&e.flagAux===e.flagAux}))[0];return Object(b.jsxs)("div",{className:M.a.inputDiv,children:[Object(b.jsxs)("div",{className:M.a.inputContainer,children:[Object(b.jsxs)("label",{children:[i,": "]}),Object(b.jsx)(V.a,{placeholder:n,style:{width:"80%"},onChange:function(e){j({type:"ADD",data:{flag:t,value:e.target.value,flagAux:a,required:u}})},defaultValue:x&&(null===x||void 0===x?void 0:x.value)?x.value:r}),Object(b.jsx)(G.a,{title:"More Info",children:Object(b.jsx)(_.a,{type:"text",shape:"circle",size:"large",icon:Object(b.jsx)(U.a,{style:{color:"blue"}})})})]}),Object(b.jsx)("div",{className:M.a.inputDescriptionDiv,children:Object(b.jsx)("span",{className:M.a.inputDescriptionText,children:c})})]})},z=a(218),H=a(72),Q=a.n(H),J=function(e){var t=e.flag,a=e.flagAux,i=e.label,n=e.placeholder,c=e.description,s=e.defaultValue,r=void 0===s?[]:s,o=e.required,u=void 0!==o&&o,d=Object(l.useContext)(I),f=d.state,j=d.dispatch,x=f.data.filter((function(e){return e.flag===t&&e.flagAux===e.flagAux}))[0];return Object(b.jsxs)("div",{className:Q.a.inputDiv,children:[Object(b.jsxs)("div",{className:Q.a.inputContainer,children:[Object(b.jsxs)("label",{children:[i,": "]}),Object(b.jsx)(z.a,{mode:"tags",style:{width:"80%"},placeholder:n,defaultValue:x&&(null===x||void 0===x?void 0:x.value)?x.value:r,onChange:function(e){j({type:"ADD",data:{flag:t,value:e,flagAux:a,required:u}})}}),Object(b.jsx)(G.a,{title:"More Info",children:Object(b.jsx)(_.a,{type:"text",shape:"circle",size:"large",icon:Object(b.jsx)(U.a,{style:{color:"blue"}})})})]}),Object(b.jsx)("div",{className:Q.a.inputDescriptionDiv,children:Object(b.jsx)("span",{className:Q.a.inputDescriptionText,children:c})})]})},W=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(w,{title:"Kics Source",children:Object(b.jsx)(P,{flag:"source",items:[{label:"Docker",flag:"source",flagAux:"docker",required:!0}]})}),Object(b.jsx)(w,{title:"Target Scan",children:Object(b.jsx)(P,{flag:"path",items:[{flag:"path",flagAux:"local",label:"Local File(s) / Folder(s)",required:!0,children:Object(b.jsx)(J,{flag:"path",flagAux:"local",required:!0,placeholder:"Add one or more files or folders (complete path)",label:"Files / Folders",description:"Example: c:\\sample.tf (single file)  \u2022  c:\\scans\\project-folder (folder)  \u2022  /home/user/project (folder)"})},{flag:"path",flagAux:"git",required:!0,label:"Git Repository",children:Object(b.jsx)(B,{flag:"path",flagAux:"git",required:!0,placeholder:"Repository URL",label:"Repository URL",description:"Example: https://github.com/Checkmarx/kics"})}]})}),Object(b.jsx)(w,{title:"Queries Location",children:Object(b.jsx)(P,{flag:"queries-path",items:[{flag:"queries-path",flagAux:"default",label:"Default (same as Kics source)"},{flag:"queries-path",flagAux:"local",required:!0,label:"Custom Location (Local Folder)",children:Object(b.jsx)(B,{flag:"queries-path",flagAux:"local",required:!0,placeholder:"Queries Assets Complete Path",label:"Query Assets",description:"Example: c:\\kics\\1.4.7\\assets"})},{flag:"queries-path",flagAux:"git",required:!0,label:"Git Repository",children:Object(b.jsx)(B,{flag:"queries-path",flagAux:"git",required:!0,placeholder:"Repository URL",label:"Repository URL",description:"Example: https://github.com/Checkmarx/kics"})}]})})]})},Y=a(224),X=function(e){var t=e.flag,a=e.items,i=e.defaultSelection,n=void 0===i?[]:i,c=e.required,s=void 0!==c&&c,r=Object(l.useContext)(I),o=r.state,u=r.dispatch,d=o.data.filter((function(e){return e.flag===t}))[0];return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(Y.a.Group,{options:a,defaultValue:d?d.value:n,onChange:function(e){u({type:"ADD",data:{flag:t,value:e,flagAux:null,required:s}})}})})},Z=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(w,{title:"Output File(s) / Report Formats",children:Object(b.jsx)(X,{flag:"report-formats",items:[{label:"JSON",value:"json"},{label:"PDF",value:"pdf"},{label:"HTML",value:"html"},{label:"SARIF (JSON)",value:"sarif"},{label:"SONARQUBE",value:"sonarqube"},{label:"GLSAST",value:"glsast"}]})}),Object(b.jsx)(w,{title:"Output Path",children:Object(b.jsx)(B,{flag:"output-path",flagAux:"local",label:"Output Path",placeholder:"Complete path to store the output file(s)",description:"Example: c:\\scans-output"})}),Object(b.jsx)(w,{title:"Output Filename",children:Object(b.jsx)(B,{flag:"output-name",flagAux:"local",label:"Output Filename",placeholder:"Output file name (without extension)",description:"Example: scan-results"})})]})},$=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(w,{title:"Minimal UI",children:Object(b.jsx)(P,{flag:"minimal-ui",defaultIndex:1,items:[{label:"Enable",flag:"minimal-ui",flagAux:"enable"},{label:"Disable",flag:"minimal-ui",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"No Progress",children:Object(b.jsx)(P,{flag:"no-progress",defaultIndex:1,items:[{label:"Enable",flag:"no-progress",flagAux:"enable"},{label:"Disable",flag:"no-progress",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"Preview Lines",children:Object(b.jsx)(P,{flag:"preview-lines",defaultIndex:1,items:[{label:"Enable",flag:"preview-lines",flagAux:null,children:Object(b.jsx)(B,{flag:"preview-lines",flagAux:null,placeholder:"Number of lines to be display in CLI results (min: 1, max: 30)",label:"N\xba of Lines",description:"Number of lines to be display in CLI results (min: 1, max: 30)",defaultValue:"3"})},{label:"Disable",flag:"preview-lines",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"No Color",children:Object(b.jsx)(P,{flag:"no-color",defaultIndex:1,items:[{label:"Enable",flag:"no-color",flagAux:"enable"},{label:"Disable",flag:"no-color",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"Output Style",children:Object(b.jsx)(P,{flag:"custom-cli-01",defaultIndex:0,items:[{flag:"custom-cli-01",flagAux:"default",label:"Default"},{flag:"custom-cli-01",flagAux:"silent",label:"Silent"},{flag:"custom-cli-01",flagAux:"verbose",label:"Verbose"}]})})]})},ee=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(w,{title:"Exclude Severities",children:Object(b.jsx)(X,{flag:"exclude-severities",items:[{label:"Info",value:"info"},{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}]})}),Object(b.jsx)(w,{title:"Include Bill of Materials (BoM)",children:Object(b.jsx)(P,{flag:"bom",defaultIndex:1,items:[{label:"Yes",flag:"bom",flagAux:"enable"},{label:"No",flag:"bom",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"Custom Query Timeout",children:Object(b.jsx)(P,{flag:"timeout",defaultIndex:1,items:[{label:"Enable",flag:"timeout",flagAux:"enable",children:Object(b.jsx)(B,{flag:"timeout",flagAux:null,placeholder:"number of seconds the query has to execute before being canceled",label:"N\xba of Seconds",description:"Number of seconds the query has to execute before being canceled)",defaultValue:"60"})},{label:"Disable",flag:"timeout",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"Disable Secrets",children:Object(b.jsx)(P,{flag:"disable-secrets",defaultIndex:1,items:[{label:"Yes",flag:"disable-secrets",flagAux:"enable"},{label:"No",flag:"disable-secrets",flagAux:"disable"}]})}),Object(b.jsx)(w,{title:"Disable Full Description",children:Object(b.jsx)(P,{flag:"disable-full-descriptions",defaultIndex:1,items:[{label:"Yes",flag:"disable-full-descriptions",flagAux:"enable"},{label:"No",flag:"disable-full-descriptions",flagAux:"disable"}]})})]})},te=a(97),ae=a(41),le=a.n(ae),ie=a(220),ne=a(215),ce=a(130),se=a(227),re=a(228),oe=a(125),ue=a.n(oe),de=V.a.TextArea,fe=ie.a.Panel,be=["source","path","queries-path","output-path"],je="/path",xe=function(){var e=Object(l.useContext)(I).state,t=Object(l.useState)([]),a=Object(s.a)(t,2),i=a[0],n=a[1],c=Object(l.useState)([]),r=Object(s.a)(c,2),o=r[0],u=r[1],d=!!e.data.filter((function(e){return"source"===e.flag&&"docker"===e.flagAux}))[0],f=[{flag:"source",func:function(e,t){var a=e.value;return d?'docker pull checkmarx/kics:latest && docker run -v "'.concat(t,"/:").concat(je,'" checkmarx/kics:latest scan'):a?"".concat(a," scan"):(n([].concat(Object(te.a)(i),['The field "Source" needs a value to build kics command. Please, fill it on "Base Scan" tab.'])),null)}},{flag:"custom-cli-01",func:function(e){switch(e.flagAux){case"verbose":return"--verbose";case"silent":return"--silent";default:return null}}}],j=function(){var t=[],a=function(e){var t=[];return t.push(e.find((function(e){return"source"===e.flag}))),t.push(e.find((function(e){return"path"===e.flag}))),t.push(e.find((function(e){return"queries-path"===e.flag}))),t.push(e.find((function(e){return"output-path"===e.flag}))),(t=t.filter((function(e){return e}))).concat(e.filter((function(e){return!be.includes(e.flag)})))}(ue.a.cloneDeep(e.data)),l=function(e){var t=e.filter((function(e){return be.includes(e.flag)&&e.value&&"local"===e.flagAux})).map((function(e){return e.value})).flat().map((function(e){return e.toLowerCase().replace(/[\\]/g,"/")}));if(0===t.length)return{isCommonPath:!0,commonPath:""};var a=t[0].split("/")[0];return{isCommonPath:t.every((function(e){return e.split("/")[0]===a})),commonPath:a}}(a),c=l.isCommonPath,s=l.commonPath;c||n([].concat(Object(te.a)(i),['All the provided flags that target to local path(s) should have a common base root path. Check if the provided paths are valid and have the full path to file/folder. Example: All the provided paths start with "C:\\" or "/home/"']));var r=function(e,t){var a=function(e){return e.replace(/[\\]/g,"/")},l=function(e){return e.replace(t,je)};return e.forEach((function(e){be.includes(e.flag)&&"local"===e.flagAux&&(Array.isArray(e.value)?e.value=e.value.map((function(e){return a(e.toLowerCase())})).map((function(e){return l(e)})):e.value=l(a(e.value.toLowerCase())))})),e}(a,s);return r.forEach((function(e){if(["default","disable"].includes(e.flagAux))return null;var a=f.find((function(t){return t.flag===e.flag}));return a?t.push(a.func(e,s)):"enable"===e.flagAux?t.push("--".concat(e.flag)):""===e.value||Array.isArray(e.value)&&0===e.value.length?(e.required&&n([].concat(Object(te.a)(i),['The flag "'.concat(e.flag,'" needs a value to build kics command. Please, fill it on "Base Scan" tab.')])),null):"git"===e.flagAux?t.push("--".concat(e.flag," git::").concat(e.value)):Array.isArray(e.value)?t.push("--".concat(e.flag," ").concat(e.value.join(","))):t.push("--".concat(e.flag," ").concat(e.value))})),t};return Object(l.useEffect)((function(){u(j())}),[]),Object(b.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",gap:"2em"},children:[Object(b.jsx)("div",{children:0===i.length?Object(b.jsxs)(O.a,{gutter:[16,8],className:le.a.container,children:[Object(b.jsxs)(v.a,{xs:24,children:[Object(b.jsx)("h3",{children:"Kics Command (Generated Output)"}),Object(b.jsx)(ne.a,{})]}),Object(b.jsxs)(v.a,{xs:24,children:[Object(b.jsxs)("span",{className:le.a.actionTitle,children:[Object(b.jsx)("b",{children:"Complete Command"})," (pull latest kics image & run kics scan)"]}),Object(b.jsxs)("div",{className:le.a.actionDiv,children:[Object(b.jsx)(de,{showCount:!0,style:{width:"100%"},value:o.join(" "),readOnly:!0}),Object(b.jsx)(_.a,{type:"primary",size:"large",style:{maxWidth:"15em"},icon:Object(b.jsx)(se.a,{}),onClick:function(){navigator.clipboard.writeText(o.join(" ")),ce.b.success("Kics Command copied to clipboard!")},children:"Copy to clipboard"})]})]}),Object(b.jsx)(ne.a,{}),Object(b.jsxs)(v.a,{xs:24,children:[Object(b.jsxs)("span",{className:le.a.actionTitle,children:[Object(b.jsx)("b",{children:"Kics Command Only"})," (when kics image has been pulled previously)"]}),Object(b.jsxs)("div",{className:le.a.actionDiv,children:[Object(b.jsx)(de,{showCount:!0,autoSize:{minRows:2,maxRows:6},style:{width:"100%"},value:o.join(" ").split(" && ")[1],readOnly:!0}),Object(b.jsx)(_.a,{type:"primary",size:"large",style:{maxWidth:"15em"},icon:Object(b.jsx)(se.a,{}),onClick:function(){navigator.clipboard.writeText(o.join(" ").split(" && ")[1]),ce.b.success("Kics Command copied to clipboard!")},children:"Copy to clipboard"})]})]}),Object(b.jsx)(ne.a,{}),Object(b.jsx)(v.a,{xs:24,children:Object(b.jsx)("div",{className:le.a.actionDiv,children:Object(b.jsx)(_.a,{className:le.a.buttonDownload,type:"outline",icon:Object(b.jsx)(re.a,{}),size:"large",onClick:function(){ce.b.loading("Starting download...")},children:"Download Scan Config"})})})]}):Object(b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1em"},children:i.map((function(e,t){return Object(b.jsxs)("span",{children:[Object(b.jsx)("span",{className:le.a.errorTag,children:"[Required Field] "}),e]},t)}))})}),Object(b.jsx)(ie.a,{defaultActiveKey:["0"],style:{width:"100%"},children:Object(b.jsx)(fe,{header:"View Kics Command Flags as List",children:Object(b.jsx)("div",{style:{minHeight:"200px",display:"flex",flexDirection:"column",gap:"1em"},children:e.data.length>0&&e.data.map((function(e){return Object(b.jsxs)("div",{children:[Object(b.jsx)("b",{children:e.flag}),":"," ",Array.isArray(e.value)?e.value.join(","):e.value," ",Object(b.jsx)("i",{children:e.flagAux&&"(".concat(e.flagAux,")")})]},e.flag)}))})},"1")})]})},pe=function(){var e=[{title:"Base Scan*",content:Object(b.jsx)(W,{})},{title:"Output Files",content:Object(b.jsx)(Z,{})},{title:"Output CLI",content:Object(b.jsx)($,{})},{title:"Scan Features",content:Object(b.jsx)(ee,{})},{title:"Finish",content:Object(b.jsx)(xe,{})}];return Object(b.jsx)(O.a,{justify:"center",children:Object(b.jsx)(v.a,{className:"gutter-row",xs:24,sm:24,md:22,lg:20,xl:18,xxl:16,children:Object(b.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1em"},children:Object(b.jsx)(N,{stepsList:e})})})})};var he=function(){var e=Object(l.useState)(!1),t=Object(s.a)(e,2),a=t[0],i=t[1],n=Object(l.useReducer)(T,F),c=Object(s.a)(n,2),r=c[0],o=c[1];return Object(b.jsxs)("div",{style:{height:"100vh",display:"flex",flexDirection:"column"},children:[Object(b.jsx)(x,{darkMode:a,setDarkMode:i}),Object(b.jsx)(m,{children:Object(b.jsx)(I.Provider,{value:{state:r,dispatch:o},children:Object(b.jsx)(pe,{})})})]})};a(213);c.a.render(Object(b.jsx)(i.a.StrictMode,{children:Object(b.jsx)(he,{})}),document.getElementById("root"))},41:function(e,t,a){e.exports={errorTag:"mainstepfinish_errorTag__jjdY4",blockDiv:"mainstepfinish_blockDiv__3SeKT",actionDiv:"mainstepfinish_actionDiv__1w3X6",actionTitle:"mainstepfinish_actionTitle__1RcxI",buttonDownload:"mainstepfinish_buttonDownload__24LxH"}},46:function(e,t,a){e.exports={container:"steps_container__6GVvm",stepsAction:"steps_stepsAction__1Rzdz",button:"steps_button__31VTv",buttonFinish:"steps_buttonFinish__SUkqw"}},64:function(e,t,a){e.exports={title:"header_title__3EkoF",header:"header_header__HZ6Fg",headerDiv:"header_headerDiv__2OTmE",githubIcon:"header_githubIcon__pmfWk"}},71:function(e,t,a){e.exports={inputContainer:"input_inputContainer__3gzVH",inputDiv:"input_inputDiv__14BDS",inputDescriptionDiv:"input_inputDescriptionDiv__2NsUX",inputDescriptionText:"input_inputDescriptionText__BaSxG"}},72:function(e,t,a){e.exports={inputContainer:"selectmult_inputContainer__bUKN4",inputDiv:"selectmult_inputDiv__34ubp",inputDescriptionDiv:"selectmult_inputDescriptionDiv__3-RUQ",inputDescriptionText:"selectmult_inputDescriptionText__WUX8P"}},96:function(e,t,a){e.exports={boxContainer:"box_boxContainer__2ojyo",boxDiv:"box_boxDiv__2QmMs",boxTitle:"box_boxTitle__3Zqjk"}}},[[214,1,2]]]);
//# sourceMappingURL=main.d4e324c1.chunk.js.map